## -*- mode:ulam -*-
#=t3520_test_compiler_elementandquarkswclassargs_nonconstantargs_error
#!
./Foo.ulam:9:9: ERROR: Constant value expression for: firstRange, is not a constant.
./Foo.ulam:9:12: ERROR: Constant value expression for: lastRange, is not a constant.
./Foo.ulam:10:25: ERROR: Constant value expression for: lastRange, is not a constant.
./Foo.ulam:9:3: ERROR: Unresolved No.1.
./Foo.ulam:9:3: ERROR: Unresolved No.2.
./Foo.ulam:10:3: ERROR: Unresolved No.3.
./Foo.ulam:10:3: ERROR: Unresolved No.4.
./Foo.ulam:11:3: ERROR: Unresolved No.5.
./Foo.ulam:11:13: ERROR: Unresolved No.6.
./Foo.ulam:11:13: ERROR: Unresolved No.7.
./Foo.ulam:11:13: ERROR: Unresolved No.8.
./Foo.ulam:7:1: Warning: 8 nodes with unresolved types remain in function <test> (Uf_4test,1).
./Foo.ulam:7:5: Warning: Summary: 8 nodes with unresolved types remain in  a single function <test> in class: Foo.
./Foo.ulam:3:9: Warning: 8 data member nodes with unresolved types remain in class 'Foo'.
./Foo.ulam:3:9: ERROR: 8 Nodes with unresolved types detected after type labeling class: Foo.
Unrecoverable Program Type Label FAILURE.
##
## Answers the question: Must class args be constant expressions? Yes.
##
#>Foo.ulam
ulam 1;
use Booly;
element Foo{
  parameter Unsigned(3) p = 3u;
  constant Unsigned(3) c = 2u;
  Unsigned(3) n = 2u;
Int test(){
  Unsigned(3) m = 0u;
  Booly(m, n, true) bv;
  Booly(c + Foo.sizeof, p, true) bc; //firstRange ok
  return bv.behave();
}
}

#:Booly.ulam
  quark Booly(Unsigned(3) firstRange, Unsigned(3) lastRange, Bool bomb) {
  Bool behave(){
    if(bomb && lastRange != firstRange) return true;
    return false;
  }
}
#.
