## -*- mode:ulam -*-
#=t3407_test_compiler_quarkwithselfaselement
#!
##      /* gen code output (assert):
##	 Int Arg: 1
##	 Int Arg: 2
##      */
##
## eval ans incorrect: i(2), exit status -11 or -1?
##
Exit status: -1
Ue_ElT { Int(32) i(0);  Typo t();  Typo r();  Int(32) test() {  System s;  t ( )incr . s ( i )print . r ( )incr . s ( i )print . s ( i 2 cast == )assert . i return } }
Uq_Typo { <NOMAIN> }
Uq_System { <NOMAIN> }
#>ElT.ulam
  ulam 1;
use Typo;
use System;
element ElT {
  Int i;
  Typo t,r;
  Int test() {
    System s;
    t.incr();
    s.print(i);
    r.incr();
    s.print(i);
    s.assert(i == 2);
    return i;
  }
}

#:Typo.ulam
  ulam 1;
quark Typo {
  Void incr(){
    Atom a = self.storageof; //atom; //self;
    if(a as ElT) {
      a.i += 1;
    }
    self.storageof = a; //atom = a; //self = a;
  }
 }
#:System.ulam
ulam 1;
quark System {
Void print(Unsigned arg) native;
Void print(Int arg) native;
Void print(Int(4) arg) native;
Void print(Int(3) arg) native;
Void print(Unary(3) arg) native;
Void print(Bool(3) arg) native;
Void assert(Bool b) native;
}
#.
